{"version":3,"file":"background.js","mappings":"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","sources":["webpack://goldenthinkerextractor/./src/background.js"],"sourcesContent":["import { extractFiltersAndValues } from './com_goldenthinkerextractor_filters_for_website/filters.js';\r\n\r\n\r\nlet tabmap = [];\r\n\r\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\r\n    if (message.action === \"startScript\") {\r\n        // Use sender.tab.id if message.tab is undefined\r\n        const tabId = sender.tab ? sender.tab.id : null;\r\n\r\n        if (!tabId) {\r\n            console.error(\"Tab ID is undefined.\");\r\n            sendResponse({ status: \"error\", message: \"Tab ID is undefined.\" });\r\n            return true;\r\n        }\r\n        \r\n        // Fetch the tab information to get its URL\r\n        chrome.tabs.get(tabId, function(tab) {\r\n            // Extract the domain from the tab's URL\r\n            const url = new URL(tab.url);\r\n            const domain = url.hostname;\r\n\r\n            console.log(\"Domain of the current tab:\", domain);\r\n\r\n            // Now proceed with injecting the script\r\n            chrome.scripting.executeScript({\r\n                target: { tabId: tabId },\r\n                files: ['com_goldenthinkerextractor_injection/' + domain + '/injection.js']\r\n            }).then(() => {\r\n                console.log(\"Script injected into tab \" + tabId);\r\n                sendResponse({ status: \"success\", domain: domain }); // Optionally include the domain in the response\r\n            }).catch((error) => {\r\n                console.error(\"Error injecting script into tab \" + tabId, error);\r\n                sendResponse({ status: \"error\", message: error.message });\r\n            });\r\n        });\r\n\r\n        return true; // indicates an asynchronous response.\r\n    } else if (message.action === \"stopScript\") {\r\n        // Handle stopScript action\r\n        sendResponse({ status: \"stopped\" });\r\n        return true;\r\n    } else if (message.action === \"openNewTab\") {\r\n          tabmap.push(message.tab.id);\r\n          chrome.tabs.create({ url: message.url, active: false }, function(newTab) {\r\n            chrome.tabs.update(newTab.id, { active: true });\r\n          });\r\n        sendResponse({status: \"new_opened_tab\",message: tabmap.pop()});\r\n      }\r\n});\r\n\r\n\r\nchrome.webRequest.onCompleted.addListener(\r\n    function(details) {\r\n      // Check if the request was rate-limited\r\n      if (details.statusCode === 429) {\r\n        console.log(\"Rate limit hit:\", details);\r\n        // Optionally, extract the Retry-After header if present\r\n        const retryAfterHeader = details.responseHeaders.find(header => header.name.toLowerCase() === \"retry-after\");\r\n        if (retryAfterHeader) {\r\n          console.log(\"Retry after (seconds):\", retryAfterHeader.value);\r\n          // Here you could broadcast a message to your content scripts or take other actions\r\n        }\r\n      }\r\n    },\r\n    {urls: [\"*://www.example.com/*\"]}, // Adjust the pattern to match the URLs you're interested in\r\n    [\"responseHeaders\"]\r\n);\r\n  \r\n\r\n  \r\n\r\n"],"names":["extractFiltersAndValues","tabmap","chrome","runtime","onMessage","addListener","message","sender","sendResponse","action","tabId","tab","id","console","error","status","tabs","get","url","URL","domain","hostname","log","scripting","executeScript","target","files","then","push","create","active","newTab","update","pop","webRequest","onCompleted","details","statusCode","retryAfterHeader","responseHeaders","find","header","name","toLowerCase","value","urls"],"sourceRoot":""}