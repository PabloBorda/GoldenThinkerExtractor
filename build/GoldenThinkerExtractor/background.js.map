{"version":3,"file":"background.js","mappings":"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","sources":["webpack://goldenthinkerextractor/./src/background.js"],"sourcesContent":["import { extractFiltersAndValues } from './com_goldenthinkerextractor_filters_for_website/filters.js';\r\n\r\n\r\n\r\n\r\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\r\n    if (message.action === \"startScript\") {\r\n        // Use sender.tab.id if message.tab is undefined\r\n        const tabId = message.tabId;\r\n\r\n        if (!tabId) {\r\n            console.error(\"Tab ID is undefined.\");\r\n            sendResponse({ status: \"error\", message: \"Tab ID is undefined.\" });\r\n            return true;\r\n        }\r\n        \r\n        // Fetch the tab information to get its URL\r\n        chrome.tabs.get(tabId, function(tab) {\r\n            // Extract the domain from the tab's URL\r\n            const url = new URL(tab.url);\r\n            const domain = url.hostname;\r\n\r\n            console.log(\"Domain of the current tab:\", domain);\r\n\r\n            // Now proceed with injecting the script\r\n            chrome.scripting.executeScript({\r\n                target: { tabId: tabId },\r\n                files: ['com_goldenthinkerextractor_injection/' + domain + '/injection.js']\r\n            }).then(() => {\r\n                console.log(\"Script injected into tab \" + tabId);\r\n                sendResponse({ status: \"success\", domain: domain }); // Optionally include the domain in the response\r\n            }).catch((error) => {\r\n                console.error(\"Error injecting script into tab \" + tabId, error);\r\n                sendResponse({ status: \"error\", message: error.message });\r\n            });\r\n        });\r\n\r\n        return true; // indicates an asynchronous response.\r\n    } else if (message.action === \"stopScript\") {\r\n        // Handle stopScript action\r\n        sendResponse({ status: \"stopped\" });\r\n        return true;\r\n    } else if (message.action === \"open_new_tab\") {\r\n          const parent_tab_id = message.tabId;\r\n          chrome.tabs.create({ url: message.url, active: false }, function(newTab) {\r\n            chrome.tabs.update(newTab.id, { active: true });\r\n            sendResponse({status: \"tab_was_opened\", message: { new_tab_id: newTab.id, parent_tab: parent_tab_id }});\r\n          }); \r\n      }\r\n});\r\n\r\n\r\nchrome.webRequest.onCompleted.addListener(\r\n    function(details) {\r\n      // Check if the request was rate-limited\r\n      if (details.statusCode === 429) {\r\n        console.log(\"Rate limit hit:\", details);\r\n        // Optionally, extract the Retry-After header if present\r\n        const retryAfterHeader = details.responseHeaders.find(header => header.name.toLowerCase() === \"retry-after\");\r\n        if (retryAfterHeader) {\r\n          console.log(\"Retry after (seconds):\", retryAfterHeader.value);\r\n          // Here you could broadcast a message to your content scripts or take other actions\r\n        }\r\n      }\r\n    },\r\n    {urls: [\"*://www.example.com/*\"]}, // Adjust the pattern to match the URLs you're interested in\r\n    [\"responseHeaders\"]\r\n);\r\n  \r\n\r\n  \r\n\r\n"],"names":["extractFiltersAndValues","chrome","runtime","onMessage","addListener","message","sender","sendResponse","action","tabId","console","error","status","tabs","get","tab","url","URL","domain","hostname","log","scripting","executeScript","target","files","then","parent_tab_id","create","active","newTab","update","id","new_tab_id","parent_tab","webRequest","onCompleted","details","statusCode","retryAfterHeader","responseHeaders","find","header","name","toLowerCase","value","urls"],"sourceRoot":""}