(()=>{function e(){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){var n=t[0].id.toString();chrome.storage.local.get([n],(function(t){var o=t[n]?t[n]:[],c=document.getElementById("elementsList");c.innerHTML="",o.forEach((function(t,n){var o=document.createElement("div");o.className="element-item",o.innerHTML="<td>".concat(t.name,": ").concat(t.selector,'</td><td></td><td></td><td><button class="removeElementButton" data-index="').concat(n,'">X</button></td>'),c.appendChild(o),o.querySelector(".removeElementButton").addEventListener("click",(function(){!function(t){chrome.tabs.query({active:!0,currentWindow:!0},(function(n){var o=n[0].id.toString();chrome.storage.local.get([o],(function(n){var c=n[o];if(c){c.splice(t,1);var a={};a[o]=c,chrome.storage.local.set(a,(function(){console.log("Selector removed for tab ID:",o),e()}))}}))}))}(n)}))}))}))}))}function t(e){var t,n,o;for(n=document.getElementsByClassName("tabcontent"),t=0;t<n.length;t++)n[t].style.display="none";for(o=document.getElementsByClassName("tablinks"),t=0;t<o.length;t++)o[t].className=o[t].className.replace(" active","");document.getElementById(e).style.display="block",evt.currentTarget.className+=" active"}document.addEventListener("DOMContentLoaded",(function(){console.log("DOMContentLoaded"),chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t=new URL(e[0].url).hostname;document.getElementById("domainName").textContent=t})),console.log("Attaching event listener to start/stopScript button"),document.getElementById("startButton").addEventListener("click",(function(){"Start"===this.innerHTML?(console.log("Start button clicked"),this.style.backgroundColor="#f44336",this.innerHTML="stopScript",chrome.tabs.query({active:!0,currentWindow:!0},(function(e){console.log("Sending 'startScript' message to background script"),chrome.runtime.sendMessage({action:"startScript",tab:e[0]},(function(e){window.close()}))}))):(console.log("stopScript button clicked"),this.style.backgroundColor="",this.innerHTML="Start",console.log("Sending 'stopScript' message to background script"),chrome.runtime.sendMessage({action:"stopScript",tab:tabs[0]},(function(e){window.close()})))})),document.getElementById("downloadButton").addEventListener("click",(function(){console.log("downloading...");var e=document.getElementById("filename").value.trim()||"download";chrome.storage.local.get(["globalResultsArray"],(function(t){if(t.globalResultsArray){var n=JSON.stringify(t.globalResultsArray,null,2),o=new Blob([n],{type:"application/json"}),c=URL.createObjectURL(o),a=document.createElement("a");a.href=c,a.download="".concat(e,".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}else console.log("No data to download.")}))})),document.getElementById("clearButton").addEventListener("click",(function(){console.log("clear"),chrome.storage.local.clear((function(){var e=chrome.runtime.lastError;e?console.error(e):console.log("Data cleared from chrome.storage.local")}))})),document.getElementById("addElementButton").addEventListener("click",(function(){var t=document.getElementById("elementName"),n=document.getElementById("elementSelector"),o=t.value.trim(),c=n.value.trim();o&&c?chrome.tabs.query({active:!0,currentWindow:!0},(function(a){var l=a[0].id.toString(),r={name:o,selector:c};chrome.storage.local.get([l],(function(o){var c=o[l]?o[l]:[];c.push(r);var a={};a[l]=c,chrome.storage.local.set(a,(function(){console.log("Selector saved for tab ID:",l),t.value="",n.value="",e()}))}))})):alert("Please fill in both name and selector fields.")})),e();for(var n=document.getElementsByClassName("tablinks"),o=0;o<n.length;o++)n[o].addEventListener("click",(function(){t(this.getAttribute("data-tab"))})),n.length>0&&n[0].click()}))})();